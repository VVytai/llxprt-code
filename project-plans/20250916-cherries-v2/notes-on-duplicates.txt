NOTE: There are duplicate cherry-picks from earlier attempts (commits 6c6676820, 3d79e90bf, e3ea69722). These don't affect functionality but exist in the history. Leaving them as-is to avoid rewriting history mid-process.
