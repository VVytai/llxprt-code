# R20-P11 — @ completion resource suggestions (Verifier)

- Timestamp (UTC): 2026-02-21T00:00:00Z
- Phase: P11 (Verifier)
- Verdict: PASS
- Prereq marker: `project-plans/gmerge-0.21.3/.completed/R20-P10.md` (present and complete)

## Evidence

1. **P10 marker exists and indicates complete worker delivery**
   - File exists: `project-plans/gmerge-0.21.3/.completed/R20-P10.md`
   - Contains implementation scope, TDD RED/GREEN evidence, typecheck evidence, and files changed.

2. **`serverName:uri` suggestion format is implemented**
   - In `packages/cli/src/ui/hooks/useAtCompletion.ts`, resource suggestions are built as:
     - `const prefixedUri = `${resource.serverName}:${resource.uri}`;`
     - Suggestion payload uses `label: prefixedUri`, `value: prefixedUri`.
   - This directly matches required format `serverName:uri`.

3. **Merged file + resource suggestions are implemented**
   - In same file, search flow produces `fileSuggestions` from file search results.
   - Resource candidates are built via registry and searched.
   - Final dispatch merges both lists:
     - `payload: [...fileSuggestions, ...resourceSuggestions]`
   - Confirms combined completion list behavior.

4. **No regression in existing file completion behavior**
   - Existing file-completion behaviors remain covered in `packages/cli/src/ui/hooks/useAtCompletion.test.ts`, including:
     - Recursive empty-pattern suggestions
     - Pattern filtering
     - Directory trailing slash behavior
     - Case-insensitive search
     - Loading-state behavior (fast/slow searches)
     - Search abort on subsequent input
     - Reset behavior on disable/error and cwd change
     - .gitignore handling
     - Undefined config fallback
     - Non-recursive mode
   - Added test validates resource suggestions specifically:
     - `should include MCP resource suggestions with serverName:uri format`
     - Expects `docs:file:///docs/readme.md` in suggestions.
   - Implementation appends resource suggestions without removing file suggestion pathing/escaping logic, preserving prior behavior.

## Final
PASS — requirements verified for format, merge behavior, and non-regression coverage.
