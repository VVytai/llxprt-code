Phase: P03
Completed: 2025-02-19
Status: Implementation complete, all tests passing

## Changes Made

### File: packages/cli/src/zed-integration/zedIntegration.ts

1. **Added import** for `getActiveProfileName` from `../runtime/runtimeSettings.js` (line 61)

2. **Modified `authenticate` method** (lines 210-229):
   - Added conditional logic to check current profile before clearing cache
   - Only clears credential cache when switching to a different profile
   - Added JSDoc comment with plan and requirement markers

## Implementation Details

```typescript
const currentProfile = getActiveProfileName();
if (currentProfile !== null && currentProfile !== profileName) {
  await clearCachedCredentialFile();
}
```

**Invalidation policy:**
- Clear cache if and only if: there is an active profile AND it differs from requested profile
- First auth (null profile): does NOT clear (cache is empty)
- Same profile re-auth: does NOT clear (reuses credentials)
- Different profile: CLEARS once before loading new profile

## Verification Results

- [x] All 11 tests pass (T1-T8 authenticate tests + 3 parseZedAuthMethodId tests)
- [x] TypeScript compilation succeeds (`npm run typecheck`)
- [x] `getActiveProfileName` correctly imported
- [x] Plan marker `@plan:PLAN-20250219-GMERGE021.R8.P03` present
- [x] Requirement marker `@requirement:REQ-3DA4-001` present
- [x] No TODO/FIXME markers in implementation
- [x] Conditional block replaces unconditional clear
- [x] No circular dependency (build succeeds)

Ready to proceed to P04 (full verification suite).
