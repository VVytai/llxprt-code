# R20-P10 â€” @ completion resource suggestions (Worker)

- Timestamp (UTC): 2026-02-21T19:10:40Z
- Phase: P10 (Worker)
- Plan: `project-plans/gmerge-0.21.3/560550f5df78-plan.md`

## Scope delivered
Extended `useAtCompletion` to include MCP resource suggestions alongside file suggestions.

Implemented behavior:
- Builds resource candidates from registry (`getResourceRegistry().getAllResources()`).
- Formats resource suggestions as `serverName:uri`.
- Matches resource suggestions by fuzzy search on `serverName:uri` and resource name.
- Merges file suggestions and resource suggestions into one completion list.
- Preserves existing file search/loading behavior.

## TDD evidence

### RED evidence
Command:

    npm run test --workspace @vybestack/llxprt-code -- src/ui/hooks/useAtCompletion.test.ts

Failing evidence recorded before final implementation:
- Added new test: `should include MCP resource suggestions with serverName:uri format`.
- Initial run failed (resource suggestion absent and related integration issues), confirming behavior did not yet pass.

### GREEN evidence
Command:

    npm run test --workspace @vybestack/llxprt-code -- src/ui/hooks/useAtCompletion.test.ts

Passing summary:
- `[OK] src/ui/hooks/useAtCompletion.test.ts (15 tests)`
- `Test Files 1 passed (1)`
- `Tests 15 passed (15)`

### Typecheck evidence
Command:

    npm run typecheck --workspace @vybestack/llxprt-code

Result:
- `tsc --noEmit`
- Exit code `0`

## Files changed in this phase
- `packages/cli/src/ui/hooks/useAtCompletion.ts`
- `packages/cli/src/ui/hooks/useAtCompletion.test.ts`

## Notes
- Implementation keeps suggestion format plain `serverName:uri` (no leading `@`) to match existing completion insertion behavior.
- Scope intentionally limited to completion suggestions only (P10).
